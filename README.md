# tRNA_seq_scripts
Scripts for tRNA-seq data analysis. 
The scripts are specifically used for analyzing data generated from a customized library construction method.
Paired-end reads from Illumina sequencing were first merged using BBMap tools (Bushnell B. – sourceforge.net/projects/bbmap/) with the script ‘merge.sh’. 
Sequencing adaptors were trimmed off automatically during the step of merging reads. By design, reads contain 6-nt UMI sequences on the 5’ ends for labeling of unique sequences. Reads were first de-duplicated to remove PCR duplicates using the script ‘clumpify.sh’, followed by trimming the UMI sequences with the script ‘trim_UMI.sh’. 
Reads also contain sample-specific 3-nt internal barcode sequences on the 3’ ends which were introduced in early steps of the library constructing process to decrease the sample handling complexity. Based on the 3-nt barcode, data were decomplexed by searching sequences ending with the barcode sequences using the grep command with options of ‘-A 2 -B 1 "XXX$"’, where “XXX” means the 3-nt barcode. After this, the 7-nt adaptor sequences (including the 3-nt barcodes) on the 3’ end of reads were further trimmed. The script used for these two steps is ‘sort_and_trim.sh’. 
The trimmed reads underwent quality control with options of ‘-t 20 -l 22’ using the script ‘quality_control_trim.sh’ to filter off reads with quality lower than 20 or length shorter than 22 nt. 
Genome was built using the script “build_genome.sh’ on the basis of the human tRNA genome sequence file named ‘hg19CCA+mito+spike-in.fasta’, which is modified from the hg19-mature-tRNA file downloaded from http://gtrnadb.ucsc.edu/Hsapi19/Hsapi19-seq.html, by removing identical genes, adding “CCA” to the ends, and adding in the mitochondrial tRNAs. 
Reads were then mapped to the reference genome using bowtie2, and the resulting SAM files were converted to the BAM files, sorted and indexed using the script ‘map_hg19-CCA.sh’.
Base identities mapped to each position of the tRNA genome and read counts associated are analyzed from the sorted BAM files using the script ‘LS-bam-readcount.sh’, with the filter ‘-b 20’ to only count reads with a minimum quality of 20 at each nucleotide position. The resulting information were output as.txt files for further analysis. 
Then, mutations were called for each position from the .txt files using a python script ‘LC2_mut.py’ and the output information were saved as separate .csv files with names ending with ‘.mut.csv’ for further analysis. 
The information of mutation rates for the most abundant gene of each tRNA isodecoder were sorted out and data from different samples were combined, using an in-house R script ‘select_and_filter.R’. 
